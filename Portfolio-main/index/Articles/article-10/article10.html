<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo lo que debes saber sobre fetch en JavaScript, por Francisco Carlos Zaragoza</title>
    <meta name="title" content="Portfolio Francisco Carlos Zaragoza Beato" />
    <meta
      name="description"
      content="Portfolio de Francisco Carlos Zaragoza Beato"
    />
    <meta
      name="keywords"
      content="portfolio, blog, javascript"
    />

    <meta name="language" content="Spanish" />
    <meta name="revisit-after" content=" days" />
    <meta name="author" content="Francisco Carlos Zaragoza beato" />

    <link rel="stylesheet" href="../../src/css/style.css" />
    <link rel="stylesheet" href="../src/css/style.css" />

    
    <link rel="apple-touch-icon" sizes="180x180" href="../../src/images/icons/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../src/images/icons/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../src/images/icons/favicon/favicon-16x16.png">
   
  </head>

  <body>
    <header class="header" id="header">
      <video class="videoBg" autoplay loop muted preload> 
        <source src="../../src/videos/bgVideo.mp4" type="video/mp4" />
        <source src="../../src/videos/bgVideo.webp" type="video/webp" />
        <source src="../../src/videos/bgVideo.gif" type="video/gif" />
        Tu navegador no soporta este video.
      </video>

      <div class="firsPartHeader">
        <div class="imageLogo">
          <a href="../../index.html">
            <picture class="logo">
              <source
                srcset="../../src/images/icons/logo/logo.webp"
                type="image/webp"
              />
              <source
                srcset="../../src/images/icons/logo/logo.png"
                type="image/png"
              />
              <img src="../../src/images/icons/logo/logo.webp" alt="logo CZB" />
            </picture>
          </a>
        </div>

        <nav class="nav">
            <img src="src/images/icons/icon-hamburger.webp" alt="Burger Menu" class="burger">
            <ul class="bar">
              <li><a href="../../index.html">Blog</a></li>
              <li><a href="../../Works/works.html">Trabajos</a></li>
              <li><a href="../../Form/form.html">Contacta me</a></li>
            </ul>
        </nav>
      </div>

      <div class="secondPartHeader">
        <h1>Todo lo que debes saber sobre fetch en JavaScript.</h1>
      </div>
    </header>
    <main class="mainArticle">
      <div class="containerArticle">
        <div class="infoAboutArticle">
          <p class="date">12/02/2022</p>
          <p class="timeToRead">5~min</p>
          <p class="author">Francisco Carlos Zaragoza Beato</p>
        </div>

        <div class="articleContent">
          <div class="intro">


        
         
          

          </div>
          <div class="mainContent">
            <h2> Peticiones HTTP con fetch </h2>

            <p>
                Fetch es el nombre de una nueva API para Javascript con la cuál podemos realizar peticiones HTTP asíncronas utilizando promesas y de forma que el código sea un poco más sencillo y menos verbose. La forma de realizar una petición es muy sencilla, básicamente se trata de llamar a fetch y pasarle por parámetro la URL de la petición a realizar:
            </p>

     

              <picture class="imageExample">
                <source
                  srcset="src/images/example_Images/example1Fetch.webp"
                  type="image/webp"
                />
                <source
                  srcset="src/images/example_Images/example1Fetch.png"
                  type="image/png"
                />
                <img
                  src="src/images/example_Images/example1Fetch.webp"
                  alt="Ejemplo de fetch."
                />
              </picture>

              <p>
                El fetch() devolverá una  que será aceptada cuando reciba una respuesta y sólo será rechazada si hay un fallo de red o si por alguna razón no se pudo completar la petición. El modo más habitual de manejar las promesas es utilizando .then(). Esto se suele reescribir de la siguiente forma, que queda mucho más simple:
              </p>
              <p>
                Vamos a examinar un código donde veamos un poco mejor como hacer la petición con fetch:
              </p>

              <picture class="imageExample">
                <source
                  srcset="src/images/example_Images/example2Fetch.webp"
                  type="image/webp"
                />
                <source
                  srcset="src/images/example_Images/example2Fetch.png"
                  type="image/png"
                />
                <img
                  src="src/images/example_Images/example2Fetch.webp"
                  alt="Ejemplo de fetch."
                />
              </picture>
              
              <p>
                Un poco más adelante, veremos como trabajar con la respuesta response, pero vamos a centrarnos ahora en el parámetro opcional options de la petición HTTP.
              </p>

              <p>
                Lo primero, y más habitual, suele ser indicar el método HTTP a realizar en la petición. Por defecto, se realizará un GET, pero podemos cambiarlos a HEAD, POST, PUT o cualquier otro tipo de método. En segundo lugar, podemos indicar objetos para enviar en el body de la petición, así como modificar las cabeceras en el campo headers:
              </p>

              <picture class="imageExample">
                <source
                  srcset="src/images/example_Images/example3Fetch.webp"
                  type="image/webp"
                />
                <source
                  srcset="src/images/example_Images/example3Fetch.png"
                  type="image/png"
                />
                <img
                  src="src/images/example_Images/example3Fetch.webp"
                  alt="Ejemplo de fetch."
                />
              </picture>

              <p>
                Por último, el campo credentials permite modificar el modo en el que se realiza la petición. Por defecto, el valor omit hace que no se incluyan credenciales en la petición, pero es posible indicar los valores same-origin, que incluye las credenciales si estamos sobre el mismo dominio, o include que incluye las credenciales incluso en peticiones a otros dominios.
              </p>
              <p>
                Recuerda que estamos realizando peticiones relativas al mismo dominio. En el caso de realizar peticiones a dominios diferentes obtendríamos un problema de CORS (Cross-Origin Resource Sharing)
              </p>

            <div class="properties">
              <h2 class="titleProperties">Propiedades</h2>
              <div class="property">
                <h3>Cabeceras (Headers)</h3>

                <p>
                    Aunque en el ejemplo anterior hemos creado las cabeceras como un Object genérico de Javascript, es posible crear un objeto Headers con el que trabajar:
                </p>
             
                <picture class="imageExample">
                  <source
                    srcset="src/images/example_Images/example4Fetch.webp"
                    type="image/webp"
                  />
                  <source
                    srcset="src/images/example_Images/example4Fetch.png"
                    type="image/png"
                  />
                  <img
                    src="src/images/example_Images/example4Fetch.webp"
                    alt="Ejemplo de fetch."
                  />
                </picture>
                    
                  <p>
                        Para ello, a parte del método .set() podemos utilizar varios otros para trabajar con cabeceras, comprobar su existencia, obtener o cambiar los valores o incluso eliminarlos.    
                  </p>
                <p>
                    Como muchos otros objetos iterables, podemos utilizar los métodos .entries(), .keys() y/o .values() para recorrerlos:
                </p>     
    
                <picture class="imageExample">
                  <source
                    srcset="src/images/example_Images/example5Fetch.webp"
                    type="image/webp"
                  />
                  <source
                    srcset="src/images/example_Images/example5Fetch.png"
                    type="image/png"
                  />
                  <img
                    src="src/images/example_Images/example5Fetch.webp"
                    alt="Ejemplo de fetch."
                  />
                </picture>
                  <p>
                    Para peticiones con pocas cabeceras no es mayor problema, pero en peticiones más complejas utilizar Headers es una buena práctica.

                  </p>

              
              </div>

              <div class="property">
                <h3>Respuesta de la petición HTTP</h3>
                <p>
                    Si volvemos a nuestro ejemplo de la petición con fetch, observaremos que en el primer .then() tenemos un objeto response. Se trata de la respuesta que nos llega del servidor web al momento de recibir nuestra petición:
                </p>

                <picture class="imageExample">
                  <source
                    srcset="src/images/example_Images/example6Fetch.webp"
                    type="image/webp"
                  />
                  <source
                    srcset="src/images/example_Images/example6Fetch.png"
                    type="image/png"
                  />
                  <img
                    src="src/images/example_Images/example6Fetch.webp"
                    alt="Ejemplo de fetch."
                  />
                </picture>

                <p>
                    Aunque en este ejemplo, simplemente estamos utilizando una arrow function que hace un return implícito de la promesa que devuelve el método .text(), dicho objeto response tiene una serie de propiedades y métodos que pueden resultarnos útiles al implementar nuestro código.
                </p>
                <p>
                    Si venimos de XMLHttpRequest, esto no nos resultará nada extraño. Las propiedades .status y statusText nos devuelven el código de error HTTP de la respuesta en formato numérico y cadena de texto respectivamente.
                </p>
                <p>
                    Sin embargo, existe una novedad respecto a XHR, y es que tenemos una propiedad .ok que nos devuelve true si el código de error de la respuesta es un valor del rango 2xx, es decir, que todo ha ido correctamente. Así pues, tenemos una forma práctica y sencilla de comprobar si todo ha ido bien al realizar la petición:
                </p>
             
                <picture class="imageExample">
                  <source
                    srcset="src/images/example_Images/example7Fetch.webp"
                    type="image/webp"
                  />
                  <source
                    srcset="src/images/example_Images/example7Fetch.png"
                    type="image/png"
                  />
                  <img
                    src="src/images/example_Images/example7Fetch.webp"
                    alt="Ejemplo de fetch."
                  />
                </picture>

                  <p>
                    Por último, tenemos la propiedad .headers que nos devuelve las cabeceras de la respuesta y la propiedad .url que nos devuelve la URL completa de la petición que hemos realizado.
                  </p>
              </div>

              <div class="property">
                <h3>Métodos de procesamiento </h3>
                <p>
                    Por otra parte, la instancia response también tiene algunos métodos interesantes, la mayoría de ellos para procesar mediante una promesa los datos recibidos y facilitar el trabajo con ellos:
                </p>
                <p>
                    Observa que en los ejemplos anteriores hemos utilizado response.text(). Este método indica que queremos procesar la respuesta como datos textuales, por lo que dicho método devolverá una Promise con los datos en texto plano, facilitando trabajar con ellos de forma manual:
                </p>
                <picture class="imageExample">
                  <source
                    srcset="src/images/example_Images/example8Fetch.webp"
                    type="image/webp"
                  />
                  <source
                    srcset="src/images/example_Images/example8Fetch.png"
                    type="image/png"
                  />
                  <img
                    src="src/images/example_Images/example8Fetch.webp"
                    alt="Ejemplo de fetch."
                  />
                </picture>
                <p>
                    Observa que en este fragmento de código, tras procesar la respuesta con response.text(), devolvemos una  con el contenido en texto plano. Esta  se procesa en el segundo .then(), donde gestionamos dicho contenido almacenado en data.
                </p>
                <p>
                    Ten en cuenta que tenemos varios métodos similares para procesar las respuestas. Por ejemplo, el caso anterior utilizando el método response.json() en lugar de response.text() sería equivalente al siguiente fragmento:
                </p>
                <picture class="imageExample">
                  <source
                    srcset="src/images/example_Images/example9Fetch.webp"
                    type="image/webp"
                  />
                  <source
                    srcset="src/images/example_Images/example9Fetch.png"
                    type="image/png"
                  />
                  <img
                    src="src/images/example_Images/example9Fetch.webp"
                    alt="Ejemplo de fetch."
                  />
                </picture>

                  <p>
                    Como se puede ver, con response.json() nos ahorraríamos tener que hacer el JSON.parse() de forma manual, por lo que el código es algo más directo.
                  </p>

                <div class="Example">
                    <h3>Ejemplo utilizando promesas </h3>
                    <p>
                        Lo que vemos a continuación sería un ejemplo un poco más completo de todo lo que hemos visto hasta ahora:
                    </p>
                    <ul class="list">
                        <li>Comprobamos que la petición es correcta con response.ok</li>
                        <li>Utilizamos response.text() para procesarla</li>
                        <li>En el caso de producirse algún error, lanzamos excepción con el código de error</li>
                        <li>Procesamos los datos y los mostramos en la consola</li>
                        <li>En el caso de que la promise  sea rechazada, capturamos el error con el catch</li>
                    </ul>
                    <picture class="imageExample">
                      <source
                        srcset="src/images/example_Images/example9Fetch.webp"
                        type="image/webp"
                      />
                      <source
                        srcset="src/images/example_Images/example9Fetch.png"
                        type="image/png"
                      />
                      <img
                        src="src/images/example_Images/example9Fetch.webp"
                        alt="Ejemplo de fetch."
                      />
                    </picture>
                    <p>
                        De hecho, podemos refactorizar un poco este ejemplo para hacerlo más legible. Creamos la función isResponseOk() para procesar la respuesta (invirtiendo el condicional para hacerlo más directo). Luego, los .then() y .catch() los utilizamos con una arrow function para simplificarlos:
                    </p>
                 
                    <picture class="imageExample">
                      <source
                        srcset="src/images/example_Images/example10Fetch.webp"
                        type="image/webp"
                      />
                      <source
                        srcset="src/images/example_Images/example10Fetch.png"
                        type="image/png"
                      />
                      <img
                        src="src/images/example_Images/example10Fetch.webp"
                        alt="Ejemplo de fetch."
                      />
                    </picture>
                      <p>
                        Sin embargo, aunque es bastante común trabajar con promesas utilizando .then(), también podemos hacer uso de async/await para manejar promesas, de una forma un poco más directa.
                      </p>
                   
                </div>

              </div>
            </div>
            </div>
        </div>
        <div class="conclusion">
          <h3>Conclusión</h3>
      
          <p>
            En este tutorial hemos aprendido a usar fetch, la manera más moderna con la que realizar conexiones asíncronas (Ajax) en el navegador. Es muy interesante porque nos permite un tratamiento estándar de las conexiones Ajax, ya que funciona igual en todos los navegadores. Además, al implementarse por medio de promesas, podemos generar código muy comprensible y de más fácil mantenimiento que con los tradicionales callbacks.
          </p>
          <div class="anotherArticle">
            <p>Otro Artículo que podría interesarte:</p>
            <a href="../article-3/article3.html">La importancia de las etiquetas semánticas en HTML..</a>
          </div>
        </div>
      </div>
      

      <div class="imageRow">
        <a href="#header">
          <img src="../src/images/up-chevron.png" alt="row up" class="row" />
        </a>
      </div>
      
    </main>

    <footer class="footer">
      <div class="firstPartFooter">
        <a href="mailto:carloszaragozabeato15@gmail.com" class="mail"
          >carloszaragozabeato15@gmail.com</a
        >
        <p class="copy">&copy; Francisco Carlos Zaragoza Beato 2022</p>
      </div>
      <div class="secondPartFooter">
        <a
          href="https://github.com/"
          class="icon github"
          title="GitHub"
          target="_blank"
          rel="noopener"
          ><svg viewBox="0 0 512 512">
            <path
              d="M256 70.7c-102.6 0-185.9 83.2-185.9 185.9 0 82.1 53.3 151.8 127.1 176.4 9.3 1.7 12.3-4 12.3-8.9V389.4c-51.7 11.3-62.5-21.9-62.5-21.9 -8.4-21.5-20.6-27.2-20.6-27.2 -16.9-11.5 1.3-11.3 1.3-11.3 18.7 1.3 28.5 19.2 28.5 19.2 16.6 28.4 43.5 20.2 54.1 15.4 1.7-12 6.5-20.2 11.8-24.9 -41.3-4.7-84.7-20.6-84.7-91.9 0-20.3 7.3-36.9 19.2-49.9 -1.9-4.7-8.3-23.6 1.8-49.2 0 0 15.6-5 51.1 19.1 14.8-4.1 30.7-6.2 46.5-6.3 15.8 0.1 31.7 2.1 46.6 6.3 35.5-24 51.1-19.1 51.1-19.1 10.1 25.6 3.8 44.5 1.8 49.2 11.9 13 19.1 29.6 19.1 49.9 0 71.4-43.5 87.1-84.9 91.7 6.7 5.8 12.8 17.1 12.8 34.4 0 24.9 0 44.9 0 51 0 4.9 3 10.7 12.4 8.9 73.8-24.6 127-94.3 127-176.4C441.9 153.9 358.6 70.7 256 70.7z"
            /></svg
        ></a>

        <a
          href="https://www.instagram.com/"
          class="icon instagram"
          title="Instagram"
          target="_blank"
          rel="noopener"
          ><svg viewBox="0 0 512 512">
            <g>
              <path
                d="M256 109.3c47.8 0 53.4 0.2 72.3 1 17.4 0.8 26.9 3.7 33.2 6.2 8.4 3.2 14.3 7.1 20.6 13.4 6.3 6.3 10.1 12.2 13.4 20.6 2.5 6.3 5.4 15.8 6.2 33.2 0.9 18.9 1 24.5 1 72.3s-0.2 53.4-1 72.3c-0.8 17.4-3.7 26.9-6.2 33.2 -3.2 8.4-7.1 14.3-13.4 20.6 -6.3 6.3-12.2 10.1-20.6 13.4 -6.3 2.5-15.8 5.4-33.2 6.2 -18.9 0.9-24.5 1-72.3 1s-53.4-0.2-72.3-1c-17.4-0.8-26.9-3.7-33.2-6.2 -8.4-3.2-14.3-7.1-20.6-13.4 -6.3-6.3-10.1-12.2-13.4-20.6 -2.5-6.3-5.4-15.8-6.2-33.2 -0.9-18.9-1-24.5-1-72.3s0.2-53.4 1-72.3c0.8-17.4 3.7-26.9 6.2-33.2 3.2-8.4 7.1-14.3 13.4-20.6 6.3-6.3 12.2-10.1 20.6-13.4 6.3-2.5 15.8-5.4 33.2-6.2C202.6 109.5 208.2 109.3 256 109.3M256 77.1c-48.6 0-54.7 0.2-73.8 1.1 -19 0.9-32.1 3.9-43.4 8.3 -11.8 4.6-21.7 10.7-31.7 20.6 -9.9 9.9-16.1 19.9-20.6 31.7 -4.4 11.4-7.4 24.4-8.3 43.4 -0.9 19.1-1.1 25.2-1.1 73.8 0 48.6 0.2 54.7 1.1 73.8 0.9 19 3.9 32.1 8.3 43.4 4.6 11.8 10.7 21.7 20.6 31.7 9.9 9.9 19.9 16.1 31.7 20.6 11.4 4.4 24.4 7.4 43.4 8.3 19.1 0.9 25.2 1.1 73.8 1.1s54.7-0.2 73.8-1.1c19-0.9 32.1-3.9 43.4-8.3 11.8-4.6 21.7-10.7 31.7-20.6 9.9-9.9 16.1-19.9 20.6-31.7 4.4-11.4 7.4-24.4 8.3-43.4 0.9-19.1 1.1-25.2 1.1-73.8s-0.2-54.7-1.1-73.8c-0.9-19-3.9-32.1-8.3-43.4 -4.6-11.8-10.7-21.7-20.6-31.7 -9.9-9.9-19.9-16.1-31.7-20.6 -11.4-4.4-24.4-7.4-43.4-8.3C310.7 77.3 304.6 77.1 256 77.1L256 77.1z"
              />
              <path
                d="M256 164.1c-50.7 0-91.9 41.1-91.9 91.9s41.1 91.9 91.9 91.9 91.9-41.1 91.9-91.9S306.7 164.1 256 164.1zM256 315.6c-32.9 0-59.6-26.7-59.6-59.6s26.7-59.6 59.6-59.6 59.6 26.7 59.6 59.6S288.9 315.6 256 315.6z"
              />
              <circle cx="351.5" cy="160.5" r="21.5" />
            </g></svg
        ></a>

        <a
          href="https://twitter.com/?lang=es"
          class="icon twitter"
          title="Twitter"
          target="_blank"
          rel="noopener"
          ><svg viewBox="0 0 512 512">
            <path
              d="M419.6 168.6c-11.7 5.2-24.2 8.7-37.4 10.2 13.4-8.1 23.8-20.8 28.6-36 -12.6 7.5-26.5 12.9-41.3 15.8 -11.9-12.6-28.8-20.6-47.5-20.6 -42 0-72.9 39.2-63.4 79.9 -54.1-2.7-102.1-28.6-134.2-68 -17 29.2-8.8 67.5 20.1 86.9 -10.7-0.3-20.7-3.3-29.5-8.1 -0.7 30.2 20.9 58.4 52.2 64.6 -9.2 2.5-19.2 3.1-29.4 1.1 8.3 25.9 32.3 44.7 60.8 45.2 -27.4 21.4-61.8 31-96.4 27 28.8 18.5 63 29.2 99.8 29.2 120.8 0 189.1-102.1 185-193.6C399.9 193.1 410.9 181.7 419.6 168.6z"
            /></svg
        ></a>

        <a
          href="https://es.linkedin.com/"
          class="icon linkedin"
          title="LinkedIn"
          target="_blank"
          rel="noopener"
          ><svg viewBox="0 0 512 512">
            <path
              d="M186.4 142.4c0 19-15.3 34.5-34.2 34.5 -18.9 0-34.2-15.4-34.2-34.5 0-19 15.3-34.5 34.2-34.5C171.1 107.9 186.4 123.4 186.4 142.4zM181.4 201.3h-57.8V388.1h57.8V201.3zM273.8 201.3h-55.4V388.1h55.4c0 0 0-69.3 0-98 0-26.3 12.1-41.9 35.2-41.9 21.3 0 31.5 15 31.5 41.9 0 26.9 0 98 0 98h57.5c0 0 0-68.2 0-118.3 0-50-28.3-74.2-68-74.2 -39.6 0-56.3 30.9-56.3 30.9v-25.2H273.8z"
            /></svg
        ></a>
      </div>
    </footer>

    <script src="../../src/script/app.js"></script>
  </body>
</html>
